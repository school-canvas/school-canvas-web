<div class="login-wrapper">
  <!-- Background decorations -->
  <div class="background-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <div class="login-container">
    <!-- Back to Home Button -->
    <button mat-icon-button class="back-button" routerLink="/" matTooltip="Back to Home">
      <mat-icon>arrow_back</mat-icon>
    </button>

    <mat-card class="login-card">
      <!-- Logo Section -->
      <div class="logo-section">
        <img [src]="appConfig.logoPath" alt="School Logo" class="school-logo">
        <h1 class="app-title">{{ appConfig.shortName }}</h1>
        <p class="welcome-text">Welcome back! Please login to your account</p>
      </div>
      
      <mat-card-content>
        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
          <!-- Username Field -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Username</mat-label>
            <input 
              matInput 
              formControlName="username" 
              placeholder="Enter your username"
              autocomplete="username">
            <mat-icon matPrefix>person</mat-icon>
            <mat-error *ngIf="loginForm.get('username')?.hasError('required')">
              Username is required
            </mat-error>
            <mat-error *ngIf="loginForm.get('username')?.hasError('minlength')">
              Username must be at least 3 characters
            </mat-error>
          </mat-form-field>
          
          <!-- Password Field -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input 
              matInput 
              [type]="hidePassword ? 'password' : 'text'" 
              formControlName="password" 
              placeholder="Enter your password"
              autocomplete="current-password">
            <mat-icon matPrefix>lock</mat-icon>
            <button type="button" mat-icon-button matSuffix (click)="hidePassword = !hidePassword">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error *ngIf="loginForm.get('password')?.hasError('required')">
              Password is required
            </mat-error>
            <mat-error *ngIf="loginForm.get('password')?.hasError('minlength')">
              Password must be at least 6 characters
            </mat-error>
          </mat-form-field>

          <!-- Remember Me & Forgot Password -->
          <div class="options-row">
            <mat-checkbox formControlName="rememberMe" color="primary">
              Remember me
            </mat-checkbox>
            <a routerLink="/auth/forgot-password" class="forgot-link">Forgot Password?</a>
          </div>
          
          <!-- Action Buttons -->
          <div class="form-actions">
            <button 
              type="button" 
              mat-stroked-button 
              class="cancel-button"
              routerLink="/"
              [disabled]="isLoading$ | async">
              <mat-icon>home</mat-icon>
              Back to Home
            </button>
            <button 
              type="submit" 
              mat-raised-button 
              color="primary" 
              class="login-button"
              [disabled]="loginForm.invalid || (isLoading$ | async)">
              <mat-spinner diameter="20" *ngIf="isLoading$ | async"></mat-spinner>
              <mat-icon *ngIf="!(isLoading$ | async)">login</mat-icon>
              <span *ngIf="!(isLoading$ | async)">Login</span>
            </button>
          </div>
        </form>
      </mat-card-content>
      
      <!-- Divider -->
      <mat-divider></mat-divider>

      <!-- Register Section -->
      <mat-card-actions class="card-actions">
        <p class="register-text">Don't have an account?</p>
        <a mat-raised-button color="accent" routerLink="/auth/register-user" class="register-button">
          <mat-icon>person_add</mat-icon>
          Create Account
        </a>
      </mat-card-actions>
      
      <!-- Loading Bar -->
      <mat-card-footer *ngIf="isLoading$ | async" class="loading-footer">
        <mat-progress-bar mode="indeterminate" color="accent"></mat-progress-bar>
      </mat-card-footer>
    </mat-card>

    <!-- Quick Login Info -->
    <div class="info-section">
      <mat-icon class="info-icon">info</mat-icon>
      <p class="info-text">
        <strong>Need help?</strong> Contact your school administrator or 
        <a routerLink="/support">visit our support page</a>
      </p>
    </div>
  </div>
  
  <!-- Auth Footer -->
  <app-auth-footer></app-auth-footer>
</div>