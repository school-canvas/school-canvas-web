<div class="student-dashboard">
  <!-- Page Header -->
  <app-page-header
    [title]="'Welcome back, ' + (studentProfile?.firstName || 'Student')"
    [subtitle]="'Here\'s what\'s happening today'">
    <button mat-raised-button color="primary" [routerLink]="['/student/schedule']">
      <mat-icon>calendar_today</mat-icon>
      View Schedule
    </button>
  </app-page-header>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    <p>Loading dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <app-stats-card
        [title]="'Total Classes'"
        [value]="totalClasses"
        [icon]="'class'"
        [color]="'primary'">
      </app-stats-card>

      <app-stats-card
        [title]="'Attendance Rate'"
        [value]="attendanceRate + '%'"
        [icon]="'check_circle'"
        [color]="attendanceRate >= 75 ? 'success' : 'warning'">
      </app-stats-card>

      <app-stats-card
        [title]="'Pending Assignments'"
        [value]="pendingAssignments"
        [icon]="'assignment'"
        [color]="pendingAssignments > 5 ? 'error' : 'success'">
      </app-stats-card>

      <app-stats-card
        [title]="'Average Grade'"
        [value]="averageGrade || 'N/A'"
        [icon]="'grade'"
        [color]="'primary'">
      </app-stats-card>
    </div>

    <!-- Main Content Grid -->
    <div class="content-grid">
      <!-- Upcoming Classes -->
      <mat-card class="section-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>class</mat-icon>
            My Classes
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <app-data-table
            *ngIf="upcomingClasses.length > 0"
            [data]="upcomingClasses"
            [columns]="classColumns"
            [actions]="classActions"
            [totalElements]="totalClasses"
            [pageSize]="5"
            (pageChange)="onPageChange($event)"
            (sortChange)="onSortChange($event)">
          </app-data-table>

          <app-empty-state
            *ngIf="upcomingClasses.length === 0"
            [icon]="'class'"
            [title]="'No classes found'"
            [message]="'You are not enrolled in any classes yet.'">
          </app-empty-state>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary" [routerLink]="['/student/classes']">
            View All Classes
          </button>
        </mat-card-actions>
      </mat-card>

      <!-- Recent Assessments -->
      <mat-card class="section-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>assignment</mat-icon>
            Recent Assessments
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <app-data-table
            *ngIf="recentGrades.length > 0"
            [data]="recentGrades"
            [columns]="gradeColumns"
            [totalElements]="recentGrades.length"
            [pageSize]="5"
            (pageChange)="onPageChange($event)"
            (sortChange)="onSortChange($event)">
          </app-data-table>

          <app-empty-state
            *ngIf="recentGrades.length === 0"
            [icon]="'assignment'"
            [title]="'No assessments found'"
            [message]="'No recent assessments available.'">
          </app-empty-state>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary" [routerLink]="['/student/assessments']">
            View All Assessments
          </button>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Quick Actions -->
    <mat-card class="quick-actions">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>bolt</mat-icon>
          Quick Actions
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="action-buttons">
          <button mat-raised-button [routerLink]="['/student/attendance']">
            <mat-icon>event_available</mat-icon>
            View Attendance
          </button>
          <button mat-raised-button [routerLink]="['/student/grades']">
            <mat-icon>grade</mat-icon>
            View Grades
          </button>
          <button mat-raised-button [routerLink]="['/student/assignments']">
            <mat-icon>assignment_turned_in</mat-icon>
            Submit Assignment
          </button>
          <button mat-raised-button [routerLink]="['/student/library']">
            <mat-icon>local_library</mat-icon>
            Library Resources
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
